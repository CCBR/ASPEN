<!DOCTYPE html><html class=writer-html5 lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content=CCBR><link rel="shortcut icon" href=../img/favicon.ico><title>ASPEN Output - ASPEN</title><link rel=stylesheet href=../css/theme.css><link rel=stylesheet href=../css/theme_extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css><link href=../css/custom.css rel=stylesheet><link href=../css/version-select.css rel=stylesheet><script>
        // Current page data
        var mkdocs_page_name = "ASPEN Output";
        var mkdocs_page_input_path = "outputs.md";
        var mkdocs_page_url = null;
      </script><!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]--><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script><script>hljs.highlightAll();</script></head> <body class=wy-body-for-nav role=document> <div class=wy-grid-for-nav> <nav data-toggle=wy-nav-shift class="wy-nav-side stickynav"> <div class=wy-side-scroll> <div class=wy-side-nav-search> <a href=.. class="icon icon-home"> ASPEN </a><div role=search> <form id=rtd-search-form class=wy-form action=../search.html method=get> <input type=text name=q placeholder="Search docs" aria-label="Search docs" title="Type search term here"> </form> </div> </div> <div class="wy-menu wy-menu-vertical" data-spy=affix role=navigation aria-label="Navigation menu"> <ul> <li class=toctree-l1><a class="reference internal" href=..>Background</a> </li> </ul> <ul> <li class=toctree-l1><a href=../introduction/ class="reference internal">Introduction to ATAC-seq</a> </li> </ul> <ul> <li class=toctree-l1><a href=../overview/ class="reference internal">Overview of ASPEN</a> </li> </ul> <ul> <li class=toctree-l1><a href=../deployment/ class="reference internal">Running ASPEN</a> </li> </ul> <ul class=current> <li class="toctree-l1 current"><a class="reference internal current" href=#>ASPEN Output</a> <ul class=current> <li class=toctree-l2><a class="reference internal" href=#workdir>Workdir</a> </li> <li class=toctree-l2><a class="reference internal" href=#resultsdir>Resultsdir</a> <ul> <li class=toctree-l3><a class="reference internal" href=#folders>Folders</a> </li> <li class=toctree-l3><a class="reference internal" href=#files>Files</a> </li> </ul> </li> </ul> </li> </ul> <ul> <li class=toctree-l1><a href=../limitations/ class="reference internal">Limitations of ASPEN</a> </li> </ul> <ul> <li class=toctree-l1><a href=../communications/ class="reference internal">Communications</a> </li> </ul> <ul> <li class=toctree-l1><a href=../changelog/ class="reference internal">Change Log</a> </li> </ul> <ul> <li class=toctree-l1><a href=../contributing/ class="reference internal">Contributing to ASPEN</a> </li> </ul> </div> </div> </nav> <section data-toggle=wy-nav-shift class=wy-nav-content-wrap> <nav class=wy-nav-top role=navigation aria-label="Mobile navigation menu"> <i data-toggle=wy-nav-top class="fa fa-bars"></i> <a href=..>ASPEN</a> </nav> <div class=wy-nav-content> <div class=rst-content><div role=navigation aria-label="breadcrumbs navigation"> <ul class=wy-breadcrumbs> <li><a href=.. class="icon icon-home" aria-label=Docs></a></li> <li class="breadcrumb-item active">ASPEN Output</li> <li class=wy-breadcrumbs-aside> <a href=https://github.com/CCBR/ASPEN/edit/main/docs/outputs.md>Edit on CCBR/ASPEN</a> </li> </ul> <hr> </div> <div role=main class=document itemscope=itemscope itemtype=http://schema.org/Article> <div class=section itemprop=articleBody> <h1 id=aspen-outputs>ASPEN Outputs<a class=headerlink href=#aspen-outputs title="Permanent link">&para;</a></h1> <h2 id=workdir>Workdir<a class=headerlink href=#workdir title="Permanent link">&para;</a></h2> <p>The workdir which is supplied as <code>-w</code> while running aspen <code>init</code>, <code>dryrun</code> and <code>run</code> commands will contain the following files:</p> <div class=highlight><pre><span></span><code>WORKDIR
├──<span class=w> </span>cluster.json
├──<span class=w> </span>config.yaml
├──<span class=w> </span>contrasts.tsv
├──<span class=w> </span>dryrun_git_commit.txt
├──<span class=w> </span>dryrun.log
├──<span class=w> </span>fastqs
├──<span class=w> </span>logs
├──<span class=w> </span>results
├──<span class=w> </span>runinfo.yaml
├──<span class=w> </span>sampleinfo.txt
├──<span class=w> </span>samples.tsv
├──<span class=w> </span>scripts
├──<span class=w> </span>slurm-48768339.out
├──<span class=w> </span>snakemake.log
├──<span class=w> </span>snakemake.stats
├──<span class=w> </span>stats
├──<span class=w> </span>submit_script.sbatch
└──<span class=w> </span>tools.yaml
</code></pre></div> <p>Here are more details about these files:</p> <table> <thead> <tr> <th>File</th> <th>File Type</th> <th>Mode (<code>-m</code>) When This File is Created/Overwritten</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>cluster.json</td> <td>JSON</td> <td>init</td> <td>Defines cluster resources per snakemake rule</td> </tr> <tr> <td>config.yaml</td> <td>YAML</td> <td>init; can be edited later</td> <td>Configurable parameters for this specific run</td> </tr> <tr> <td>contrasts.tsv</td> <td>TSV</td> <td>Needs to be added in after init</td> <td>List of contrasts to run, one per line; has no header</td> </tr> <tr> <td>dryrun_git_commit.txt</td> <td>TXT</td> <td>dryrun</td> <td>The git commit hash of the version of ASPEN used at dryrun</td> </tr> <tr> <td>dryrun.log</td> <td>TXT</td> <td>dryrun</td> <td>Log from <code>-m=dryrun</code></td> </tr> <tr> <td>fastqs</td> <td>FOLDER</td> <td>dryrun</td> <td>Folder containing symlinks to raw data</td> </tr> <tr> <td>logs</td> <td>FOLDER</td> <td>dryrun</td> <td>Folder containing all logs including Slurm <code>.out</code> and <code>.err</code> files</td> </tr> <tr> <td>results</td> <td>FOLDER</td> <td>Created at dryrun but populated during run</td> <td>Main outputs folder</td> </tr> <tr> <td>runinfo.yaml</td> <td>YAML</td> <td>After completion of run</td> <td>Metadata about the run executor, etc.</td> </tr> <tr> <td>sampleinfo.txt</td> <td>TXT</td> <td>dryrun, run</td> <td>Tab-delimited mappings between <code>replicateNames</code> and <code>sampleNames</code></td> </tr> <tr> <td>samples.tsv</td> <td>TSV</td> <td>init; can be edited later</td> <td>Tab-delimited manifest with <code>replicateName</code>, <code>sampleName</code>, <code>path_to_R1_fastq</code>, <code>path_to_R2_fastq</code>. This file has a header.</td> </tr> <tr> <td>scripts</td> <td>FOLDER</td> <td>init</td> <td>Folder keeps local copy of scripts called by various rules</td> </tr> <tr> <td>slurm-49051815.out</td> <td>TXT</td> <td>run</td> <td>Slurm <code>.out</code> file for the master job</td> </tr> <tr> <td>snakemake.log</td> <td>TXT</td> <td>run</td> <td>Snakemake <code>.log</code> file for the master job; older copies timestamped and moved into <code>logs</code> folder</td> </tr> <tr> <td>stats</td> <td>FOLDER</td> <td>Created at dryrun but populated during run</td> <td>Contains older timestamped <code>runinfo.yaml</code> files</td> </tr> <tr> <td>submit_script.sbatch</td> <td>TXT</td> <td>run</td> <td>Slurm script to kickstart the main Snakemake job</td> </tr> <tr> <td>tools.yaml</td> <td>YAML</td> <td>run</td> <td>YAML containing the version of tools used in the pipeline (obsolete; was used to load specific module versions prior to moving over to Docker/Singularity containers)</td> </tr> </tbody> </table> <h2 id=resultsdir>Resultsdir<a class=headerlink href=#resultsdir title="Permanent link">&para;</a></h2> <p>The results directory contains the actual output files. Below are the folders that you may find within it.</p> <div class=highlight><pre><span></span><code>WORKDIR
├──<span class=w> </span>results
<span class=w>    </span>├──<span class=w> </span>dedupBam
<span class=w>    </span>├──<span class=w> </span>peaks
<span class=w>    </span>├──<span class=w> </span>QC
<span class=w>    </span>├──<span class=w> </span>qsortedBam
<span class=w>    </span>├──<span class=w> </span>tagAlign
<span class=w>    </span>└──<span class=w> </span>tmp
</code></pre></div> <p>Content details:</p> <table> <thead> <tr> <th>Folder</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>dedupBam</code></td> <td>Deduplicated filtered BAM files; can be used for visualization.</td> </tr> <tr> <td><code>peaks</code></td> <td>Genrich/MACS2 peak calls (raw, consensus, fixed-width); also contains ROI files with Diff-ATAC results if <code>contrasts.tsv</code> is provided; motif enrichments using HOMER and AME; bigwigs for visualization.</td> </tr> <tr> <td><code>QC</code></td> <td>Flagstats; dupmetrics; read counts; motif enrichments; FLD stats; Fqscreen; FRiP; ChIPSeeker results; TSS enrichments; Preseq; MultiQC.</td> </tr> <tr> <td><code>qsortedBam</code></td> <td>Query name sorted BAM files; used for Genrich peak calling (includes multimappers).</td> </tr> <tr> <td><code>tagAlign</code></td> <td><code>tagAlign.gz</code> files; deduplicated; used for MACS2 peak calling.</td> </tr> <tr> <td><code>tmp</code></td> <td>Can be deleted; blacklist index; intermediate FASTQs; Genrich output reads.</td> </tr> </tbody> </table> <p>The <code>QC</code> folder contains the <code>multiqc_report.html</code> file which provides a comprehensive summary of the quality control metrics across all samples, including read quality, duplication rates, and other relevant statistics. This report aggregates results from various QC tools such as FastQC, FastqScreen, FLD, TSS enrichment, Peak Annotations, and others, presenting them in an easy-to-read format with interactive plots and tables. It helps in quickly identifying any issues with the sequencing data and ensures that the data quality is sufficient for downstream analysis.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>BAM files from <code>dedupBam</code> can be used for downstream footprinting analysis using <a href=https://github.com/CCBR/CCBR_Tobias>CCBR_TOBIAS</a> pipeline</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p><a href=https://deeptools.readthedocs.io/en/develop/content/tools/bamCompare.html>bamCompare</a> from deeptools can be run to compare BAMs from <code>dedupBam</code> for comprehensive BAM comparisons.</p> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>BAM files from <code>dedupBam</code> can also be converted to BED format and processed with <a href=https://github.com/GreenleafLab/chromVAR>chromVAR</a> to identify variability in motif accessibility across samples and assess differentially active transcription factors from the JASPAR database.</p> </div> <p>Most of the above folders are self-explanatory. The <code>peaks</code> folder has this hierarchy:</p> <div class=highlight><pre><span></span><code>WORKDIR
├──<span class=w> </span>results
<span class=w>    </span>├──<span class=w> </span>peaks
<span class=w>        </span>├──<span class=w> </span>genrich
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.genrich.narrowPeak
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.genrich.narrowPeak.annotated
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.genrich.narrowPeak.genelist
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.genrich.narrowPeak.annotation_summary
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.genrich.narrowPeak.annotation_distribution
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;sampleName&gt;.genrich.pooled.narrowPeak
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;sampleName&gt;.genrich.consensus.bed
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>ROI.counts.tsv
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>bigwig
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.genrich.narrowPeak_motif_enrichment
<span class=w>        </span>│<span class=w>   </span>│<span class=w>   </span>└──<span class=w> </span>knownResults
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>DiffATAC
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.genrich.consensus.bed_motif_enrichment
<span class=w>        </span>│<span class=w>   </span>└──<span class=w> </span>tn5nicks
<span class=w>        </span>└──<span class=w> </span>macs2
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.macs2.narrowPeak
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.macs2.narrowPeak.annotated
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.macs2.narrowPeak.genelist
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.macs2.narrowPeak.annotation_summary
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.macs2.narrowPeak.annotation_distribution
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;sampleName&gt;.macs2.pooled.narrowPeak
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;sampleName&gt;.macs2.consensus.bed
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>ROI.counts.tsv
<span class=w>            </span>├──<span class=w> </span>bigwig
<span class=w>            </span>├──<span class=w> </span>&lt;replicateName&gt;.macs2.narrowPeak_motif_enrichment
<span class=w>            </span>│<span class=w>   </span>└──<span class=w> </span>knownResults
<span class=w>            </span>├──<span class=w> </span>DiffATAC
<span class=w>        </span>│<span class=w>   </span>├──<span class=w> </span>&lt;replicateName&gt;.macs2.consensus.bed_motif_enrichment
<span class=w>            </span>├──<span class=w> </span>fixed_width
<span class=w>            </span>└──<span class=w> </span>tn5nicks
</code></pre></div> <p>Some of the important folders and files are highlighted below:</p> <h3 id=folders>Folders<a class=headerlink href=#folders title="Permanent link">&para;</a></h3> <ul> <li><code>bigwig</code>: </li> </ul> <p>For easy visualization, they are converted to bigWig format and saved in respective <code>bigwig</code> folders. The bigWig files can be directly loaded into <a href=https://genome.ucsc.edu/ >UCSC Browser</a> or <a href=https://igv.org/doc/desktop/ >IGV</a>.</p> <ul> <li><code>tn5nicks</code>: </li> </ul> <p>This folder host the per-replicate BAM files containing the Tn5 nicking sites in Genrich or MACS2 "peakcalling" reads, respectively. </p> <ul> <li><code>DiffATAC</code>: </li> </ul> <p>Contains the DESeq2 differential accessiblity results, both per-contrast and aggregated accross all contrasts in <code>contrasts.tsv</code>. These results are solely based on tn5 nick counts.</p> <ul> <li><code>fixed_width</code>: </li> </ul> <p>This folder contains fixed-width consensus peaks across replicates and samples, represented in the "Regions-Of-Interest" files. The <code>ROI.bed</code> file lists genomic regions where chromatin accessibility is analyzed using DESeq2, with results stored in the <code>DiffATAC</code> folder.</p> <ul> <li><code>&lt;replicateName&gt;.macs2.narrowPeak_motif_enrichment</code>;<code>&lt;replicateName&gt;.genrich.narrowPeak_motif_enrichment</code>;<code>&lt;replicateName&gt;.macs2.consensus.bed_motif_enrichment</code>;<code>&lt;replicateName&gt;.genrich.consensus.bed_motif_enrichment</code>:</li> </ul> <p>Contains the motif enrichments calculated using HOMER and AME for peaks called for each replicate, sample consensus peaks using both MACS2 and Genrich. Specifically, two types of motif enrichments are performed:</p> <ul> <li> <p>Enrichment of known <a href=https://hocomoco11.autosome.org/ >HOCOMOCO</a> (version 11) motifs for HUMAN or MOUSE or BOTH using <a href=http://homer.ucsd.edu/homer/ngs/peaks.html>HOMER</a>. See file <code>knownResults.html</code>.</p> </li> <li> <p><em>de novo</em> motif enrichment using <a href=https://meme-suite.org/meme/doc/ame.html>AME</a> from MEME suite. See file <code>ame_results.txt</code>. Custom parallelization is used to optimize AME based enrichment analysis.</p> </li> </ul> <h3 id=files>Files<a class=headerlink href=#files title="Permanent link">&para;</a></h3> <ul> <li><code>*.narrowPeak</code>:</li> </ul> <p>Called peaks from Genrich or MACS2</p> <ul> <li>Annotated peak files:</li> </ul> <p>Peaks are annotated with ChIPSeeker and results are saved in the following files:</p> <ul> <li> <p><code>.annotated</code></p> <p>Tab-delimited txt file with the following columns:</p> </li> </ul> <table> <thead> <tr> <th>Column Number</th> <th>Field Name</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>#peakID</td> <td>Peak identifier</td> </tr> <tr> <td>2</td> <td>chrom</td> <td>Peak chromosome</td> </tr> <tr> <td>3</td> <td>chromStart</td> <td>Peak start coordinate</td> </tr> <tr> <td>4</td> <td>chromEnd</td> <td>Peak end coordinate</td> </tr> <tr> <td>5</td> <td>width</td> <td>Peak width</td> </tr> <tr> <td>6</td> <td>annotation</td> <td>Peak annotation (Promoter; 3' or 5' UTR; Distal; Downstream; Exon; Intron)</td> </tr> <tr> <td>7</td> <td>geneChr</td> <td>Gene chromosome</td> </tr> <tr> <td>8</td> <td>geneStart</td> <td>Gene start coordinate</td> </tr> <tr> <td>9</td> <td>geneEnd</td> <td>Gene end coordinate</td> </tr> <tr> <td>10</td> <td>geneLength</td> <td>Gene length (including introns)</td> </tr> <tr> <td>11</td> <td>geneStrand</td> <td>Gene strand</td> </tr> <tr> <td>12</td> <td>geneId</td> <td>Gene identifier</td> </tr> <tr> <td>13</td> <td>transcriptId</td> <td>Transcript identifier</td> </tr> <tr> <td>14</td> <td>distanceToTSS</td> <td>Distance of peak from the Transcription Start Site</td> </tr> <tr> <td>15</td> <td>ENSEMBL</td> <td>Gene Ensembl ID</td> </tr> <tr> <td>16</td> <td>SYMBOL</td> <td>Gene symbol</td> </tr> <tr> <td>17</td> <td>GENENAME</td> <td>Gene description</td> </tr> <tr> <td>18</td> <td>score</td> <td>Score from <code>.narrowPeak</code> file</td> </tr> <tr> <td>19</td> <td>signalValue</td> <td>Signal from <code>.narrowPeak</code> file</td> </tr> <tr> <td>20</td> <td>pValue</td> <td>p-value from <code>.narrowPeak</code> file</td> </tr> <tr> <td>21</td> <td>qValue</td> <td>q-value from <code>.narrowPeak</code> file</td> </tr> <tr> <td>22</td> <td>peak</td> <td>Distance of peak summit from peak start coordinate</td> </tr> </tbody> </table> <ul> <li><code>.genelist</code></li> </ul> <p>This is a tab-delimited file with names (Ensembl ID, gene symbol) of genes which have ATAC-seq peaks in their promotor regions. This file can be used downstream for gene enrichment analysis (ORA or over-representation analysis).</p> <ul> <li><code>.annotation_summary</code>; <code>.annotation_distribution</code></li> </ul> <p>Tab-delimited files that provide statistics on peak annotations, quantifying the number of peaks found in Promoters, Exonic regions, Distal Intergenic regions, etc. The <code>.annotation_distribution</code> is use to create visualization of these annotation-distributions in the MultiQC report.</p> <ul> <li><code>ROI.counts.tsv</code></li> </ul> <p>This file contains the read counts for each Region-Of-Interest (ROI) across all replicates of all samples. It is a tab-delimited file with the following columns:</p> <table> <thead> <tr> <th>Column Number</th> <th>Field Name</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Geneid</td> <td>Region-Of-Interest identifier</td> </tr> <tr> <td>2</td> <td>Chr</td> <td>Chromosome of the ROI</td> </tr> <tr> <td>3</td> <td>Start</td> <td>Start coordinate of the ROI</td> </tr> <tr> <td>4</td> <td>End</td> <td>End coordinate of the ROI</td> </tr> <tr> <td>5</td> <td>Strand</td> <td>"."</td> </tr> <tr> <td>6</td> <td>Length</td> <td>Length of the ROI</td> </tr> <tr> <td>7</td> <td>sample1_replicate1</td> <td>Tn5 nicking site counts in this ROI for replicate1 of sample1</td> </tr> <tr> <td>8</td> <td>sample1_replicate2</td> <td>Tn5 nicking site counts in this ROI for replicate2 of sample1</td> </tr> <tr> <td>...</td> <td>...</td> <td>...</td> </tr> <tr> <td>n</td> <td>sampleN_replicateM</td> <td>Tn5 nicking site counts in this ROI for replicateM of sampleN</td> </tr> </tbody> </table> <p>Each row represents a specific ROI, and the columns contain the read counts for each sample, allowing for differential accessibility analysis.</p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>DISCLAIMER: This folder hierarchy is specific to v1.0.6 and is subject to change with version.</p> </div> </div> </div><script async src="https://www.googletagmanager.com/gtag/js?id=G-D3SL9V30KL"></script> <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D3SL9V30KL'); // Replace with your tracking ID
</script> </div> </div> </section> </div> <div class=rst-versions role=note aria-label=Versions> <span class=rst-current-version data-toggle=rst-current-version> <span> <a href=https://github.com/CCBR/ASPEN class="fa fa-code-fork" style="color: #fcfcfc"> CCBR/ASPEN</a> </span> <span><a href=../deployment/ style="color: #fcfcfc">&laquo; Previous</a></span> <span><a href=../limitations/ style="color: #fcfcfc">Next &raquo;</a></span> </span> </div> <script src=../js/jquery-3.6.0.min.js></script> <script>var base_url = "..";</script> <script src=../js/theme_extra.js></script> <script src=../js/theme.js></script> <script src=../js/custom.js></script> <script src=../search/main.js></script> <script src=../js/version-select.js></script> <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script> </body> </html> 